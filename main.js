(()=>{"use strict";var e={formSelector:".popup__form",inputSelector:".popup__form-input",submitButtonSelector:".popup__form-button",errorClass:"popup__form-error_visible"};function t(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var n=function(){function e(t){var n=t.id,r=t.nameSelector,o=t.jobSelector;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=n,this._nameElement=document.querySelector(r),this._jobElement=document.querySelector(o)}var n,r;return n=e,(r=[{key:"getUserInfo",value:function(){return{id:this._id,name:this._nameElement.textContent,job:this._jobElement.textContent}}},{key:"setUserInfo",value:function(e){var t=e.id,n=e.name,r=e.job;this._id=t,this._nameElement.textContent=n,this._jobElement.textContent=r}}])&&t(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}();function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var o=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._avatarElement=document.querySelector(t)}var t,n;return t=e,(n=[{key:"getAvatar",value:function(){return this._avatarElement.getAttribute("src")}},{key:"setAvatar",value:function(e){this._avatarElement.setAttribute("src",e)}}])&&r(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._section=document.querySelector(n),this._items=t.items,this._renderer=t.renderer}var t,n;return t=e,(n=[{key:"addItem",value:function(e){this._section.prepend(e)}},{key:"renderContent",value:function(){var e=this;this._items.forEach((function(t){e._renderer(t)}))}}])&&i(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._popupClose=this._popup.querySelector(".popup__close"),this._bindedEscCloseHandler=this._handleEscClose.bind(this),this._bindOversideClickHandler=this._handleOversideClick.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_show"),document.addEventListener("keyup",this._bindedEscCloseHandler)}},{key:"close",value:function(){this._popup.classList.remove("popup_show"),document.removeEventListener("keyup",this._bindedEscCloseHandler)}},{key:"setEventListeners",value:function(){this._popup.addEventListener("click",this._bindOversideClickHandler),this._popupClose.addEventListener("click",this.close.bind(this))}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"_handleOversideClick",value:function(e){e.target===e.currentTarget&&this.close()}}])&&c(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function h(){return h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=b(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},h.apply(this,arguments)}function b(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function _(e,t){if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=m(r);if(o){var n=m(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return _(this,e)});function u(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(n=i.call(this,e))._form=n._popup.querySelector(".popup__form"),n._submitButton=n._form.querySelector("button"),n._originButtonText=n._submitButton.textContent,n._submitHandler=t,n}return t=u,(n=[{key:"setEventListeners",value:function(){var e=this;h(m(u.prototype),"setEventListeners",this).call(this),this._form.addEventListener("submit",(function(t){t.preventDefault();var n=e._getInputValues();e._submitButton.textContent+=" ...",e._submitHandler(n)}))}},{key:"close",value:function(){this._submitButton.textContent=this._originButtonText,this._form.reset(),h(m(u.prototype),"close",this).call(this)}},{key:"_getInputValues",value:function(){return Array.from(this._form.querySelectorAll(".popup__form-input")).reduce((function(e,t){return s(s({},e),{},p({},t.name,t.value))}),{})}}])&&y(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(a);function w(e){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},w(e)}function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function g(){return g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=k(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(arguments.length<3?e:n):o.value}},g.apply(this,arguments)}function k(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=E(e)););return e}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function P(e,t){if(t&&("object"===w(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function E(e){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},E(e)}var S=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=E(r);if(o){var n=E(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return P(this,e)});function u(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,e))._image=t._popup.querySelector(".popup__figure-img"),t._imageName=t._popup.querySelector(".popup__figure-text"),t}return t=u,(n=[{key:"open",value:function(e,t){this._image.setAttribute("src",e),this._image.setAttribute("alt",t),this._imageName.textContent=t,g(E(u.prototype),"open",this).call(this)}}])&&O(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(a);function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var R=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._settings=t,this._form=n,this._inputs=Array.from(this._form.querySelectorAll(this._settings.inputSelector)),this._submit=this._form.querySelector(this._settings.submitButtonSelector)}var t,n;return t=e,(n=[{key:"enableValidation",value:function(){this._setEventListeners(this._form,this._submit,this._inputs)}},{key:"checkFormValidityBeforeOpen",value:function(){this._hideAllErrorMessages(this._form,this._inputs),this._toggleButtonState(this._submit,this._inputs)}},{key:"_toggleButtonState",value:function(e,t){t.some((function(e){return 1!=e.validity.valid}))?e.setAttribute("disabled",!0):e.removeAttribute("disabled")}},{key:"_checkInputValidity",value:function(e,t){t.validity.valid?this._hideErrorMessage(e,t):this._showErrorMessage(e,t)}},{key:"_showErrorMessage",value:function(e,t){e.querySelector(".".concat(t.id,"-error")).textContent=t.validationMessage}},{key:"_hideErrorMessage",value:function(e,t){e.querySelector(".".concat(t.id,"-error")).textContent=""}},{key:"_hideAllErrorMessages",value:function(e,t){var n=this;t.forEach((function(t){n._hideErrorMessage(e,t)}))}},{key:"_setEventListeners",value:function(e,t,n){var r=this;n.forEach((function(o){o.addEventListener("input",(function(){r._checkInputValidity(e,o),r._toggleButtonState(t,n)}))}))}}])&&C(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var T=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._card=t,this._likes=n,this._handler=r.bind(this),this._likeElement=t._element.querySelector(".element__like"),this._likeCounterElement=t._element.querySelector(".element__number"),this._likeElement.addEventListener("click",this._likeHendler.bind(this)),this._likeCounterElement.textContent=n.length}var t,n;return t=e,(n=[{key:"setLike",value:function(e){this._likes=e,this.updateLike()}},{key:"isLike",value:function(){return this._isHasMyLike()}},{key:"getCardId",value:function(){return this._card._id}},{key:"updateLike",value:function(){this._isHasMyLike()?this._likeElement.classList.add("element__like_active"):this._likeElement.classList.remove("element__like_active"),this._likeCounterElement.textContent=this._likes.length}},{key:"_likeHendler",value:function(e){this._likeElement.textContent=e.length,this._handler(this)}},{key:"_isHasMyLike",value:function(){var e=this;return this._likes.some((function(t){return t._id==e._card._userInfo.id}))}}])&&q(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function L(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var I=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._card=t,this._confirmPopup=this._card._confirmPopup,this._buttonDeleteCard=this._card._element.querySelector(".element__trash"),this._buttonDeleteCard.addEventListener("click",(function(){return n._openPopup()}))}var t,n;return t=e,(n=[{key:"removeDeleteButton",value:function(){this._card._userInfo.id!=this._card._ownerId&&this._buttonDeleteCard.remove()}},{key:"_openPopup",value:function(){this._confirmPopup._form.id.value=this._card._id,this._confirmPopup.open()}}])&&L(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=function(){function e(t,n,r,o,i,u){var c=r.ownerId,a=r.cardId,l=r.name,f=r.link,s=r.likes;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._text=l,this._link=f,this._id=a,this._ownerId=c,this._userInfo=n.getUserInfo(),this._popupOpenHandler=o,this._element=document.querySelector(t).content.cloneNode(!0),this._elementTitle=this._element.querySelector(".element__title"),this._elementImage=this._element.querySelector(".element__image"),this._elementLike=this._element.querySelector(".element__number"),this._confirmPopup=u,this._like=new T(this,s,i),this._trash=new I(this)}var t,n;return t=e,(n=[{key:"getElement",value:function(){var e=this;return this._elementTitle.textContent=this._text,this._element.querySelector(".element").setAttribute("id",this._id),this._elementImage.setAttribute("src",this._link),this._elementImage.setAttribute("alt","Фотография места с названием '".concat(this._text,"'.")),this._elementImage.addEventListener("click",(function(){return e._handleShowImg(e._link,e._text)})),this._like.updateLike(),this._trash.removeDeleteButton(),this._element}},{key:"_handleShowImg",value:function(e,t){this._popupOpenHandler(e,t)}}])&&x(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=n,this._login=r,this._settings={method:t,headers:{authorization:o}}}var t,n;return t=e,(n=[{key:"_makeUrl",value:function(e){return"".concat(this._baseUrl,"/").concat(this._login,"/").concat(e)}},{key:"_query",value:function(e,t,n){var r=this;fetch(this._makeUrl(t),e).then((function(o){o.ok?o.json().then((function(e){n(e)})):console.log("".concat(e.method," запрос по адресу ").concat(r._makeUrl(t)," завершился ошибкой: ").concat(o.status))}))}}])&&A(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function H(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}function M(e,t){if(t&&("object"===D(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function F(e){return F=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},F(e)}var N=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=F(r);if(o){var n=F(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return M(this,e)});function u(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,"GET",e,t,n)}return t=u,(n=[{key:"query",value:function(e,t){this._query(this._settings,e,t)}}])&&H(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(U);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function G(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return J=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},J(e,t)}function K(e,t){if(t&&("object"===z(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function Q(e){return Q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Q(e)}var W=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&J(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=Q(r);if(o){var n=Q(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return K(this,e)});function u(e,t,n,r){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(o=i.call(this,e,t,n,r))._settings.headers["Content-Type"]="application/json",o}return t=u,(n=[{key:"query",value:function(e,t,n){this._settings.body=JSON.stringify(t),this._query(this._settings,e,n)}}])&&G(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(U);function X(e){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(e)}function Y(e,t){return Y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Y(e,t)}function Z(e,t){if(t&&("object"===X(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function $(e){return $=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$(e)}var ee=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Y(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=$(n);if(r){var o=$(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return Z(this,e)});function i(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"PATCH",e,t,n)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(W);function te(e){return te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},te(e)}function ne(e,t){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ne(e,t)}function re(e,t){if(t&&("object"===te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function oe(e){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},oe(e)}var ie=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ne(e,t)}(i,e);var t,n,r,o=(n=i,r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=oe(n);if(r){var o=oe(this).constructor;e=Reflect.construct(t,arguments,o)}else e=t.apply(this,arguments);return re(this,e)});function i(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),o.call(this,"POST",e,t,n)}return t=i,Object.defineProperty(t,"prototype",{writable:!1}),t}(W);function ue(e){return ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ue(e)}function ce(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ae(e,t){return ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ae(e,t)}function le(e,t){if(t&&("object"===ue(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function fe(e){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},fe(e)}var se=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ae(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=fe(r);if(o){var n=fe(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return le(this,e)});function u(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,"PUT",e,t,n)}return t=u,(n=[{key:"query",value:function(e,t){this._query(this._settings,e,t)}}])&&ce(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(W);function pe(e){return pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pe(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function he(e,t){return he=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},he(e,t)}function be(e,t){if(t&&("object"===pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function de(e){return de=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},de(e)}var _e=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&he(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=de(r);if(o){var n=de(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return be(this,e)});function u(e,t,n){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,"DELETE",e,t,n)}return t=u,(n=[{key:"query",value:function(e,t){this._query(this._settings,e,t)}}])&&ye(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(W);function me(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ve=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._baseUrl=t,this._login=n,this._token=r,this._get=new N(this._baseUrl,this._login,this._token),this._patch=new ee(this._baseUrl,this._login,this._token),this._post=new ie(this._baseUrl,this._login,this._token),this._put=new se(this._baseUrl,this._login,this._token),this._delete=new _e(this._baseUrl,this._login,this._token)}var t,n;return t=e,(n=[{key:"getInitialCards",value:function(e){this._get.query("cards",e)}},{key:"getUserInfo",value:function(e){this._get.query("users/me",e)}},{key:"updateUserInfo",value:function(e,t){this._patch.query("users/me",e,t)}},{key:"addCard",value:function(e,t){this._post.query("cards",e,t)}},{key:"updateAvatar",value:function(e,t){this._patch.query("users/me/avatar",e,t)}},{key:"setLike",value:function(e,t){this._put.query("cards/".concat(e,"/likes"),t)}},{key:"deleteLike",value:function(e,t){this._delete.query("cards/".concat(e,"/likes"),t)}},{key:"deleteCard",value:function(e,t){this._delete.query("cards/".concat(e),t)}}])&&me(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}(),we=document.querySelector(".cards"),Oe=document.querySelector(".popup_profile"),ge=document.querySelector(".profile__edit"),ke=Oe.querySelector(".popup__form"),je=Oe.querySelector(".popup__form-input[name=name]"),Pe=Oe.querySelector(".popup__form-input[name=job]"),Ee=document.querySelector(".popup_card"),Se=document.querySelector(".profile__button"),Ce=Ee.querySelector(".popup__form"),Re=document.querySelector(".popup_avatar-editing"),qe=document.querySelector(".profile__avatar"),Te=Re.querySelector(".popup__form"),Le=new R(e,Ce),Ie=new R(e,ke),xe=new R(e,Te),Be=new n({nameSelector:".profile__name",jobSelector:".profile__job"}),Ae=new o(".profile__avatar"),Ue=new ve("https://mesto.nomoreparties.co/v1/","cohort-43","ee068133-e055-42c6-88de-c45211ca2bd0");Ue.getInitialCards((function(e){e.forEach((function(e){var t=ze({ownerId:e.owner._id,cardId:e._id,name:e.name,link:e.link,likes:e.likes});De.addItem(t.getElement())}))})),Ue.getUserInfo((function(e){Be.setUserInfo({id:e._id,name:e.name,job:e.about}),Ae.setAvatar(e.avatar)}));var De=new u({items:[],renderer:function(e){var t=ze(e);we.append(t.getElement())}},".cards"),He=new v(".popup_profile",(function(e){var t={name:e.name,about:e.job};Ue.updateUserInfo(t,(function(e){Be.setUserInfo({name:e.name,job:e.about}),He.close()}))})),Ve=new v(".popup_card",(function(e){var t={name:e.title,link:e.link};Ue.addCard(t,(function(e){t.ownerId=e.owner._id,t.cardId=e._id,t.likes=e.likes;var n=ze(t);De.addItem(n.getElement()),Ve.close()}))})),Me=new v(".popup_avatar-editing",(function(e){Ue.updateAvatar({avatar:e.link},(function(e){Ae.setAvatar(e.avatar),Me.close()}))})),Fe=new S(".popup_image"),Ne=new v(".popup_confirm-deleted",(function(e){var t=e.id;Ue.deleteCard(t,(function(){document.getElementById(t).remove(),Ne.close()}))}));function ze(e){return new B(".template",Be,e,Ge,Je,Ne)}function Ge(e,t){Fe.open(e,t)}function Je(e){e.isLike()?Ue.deleteLike(e.getCardId(),(function(t){e.setLike(t.likes)})):Ue.setLike(e.getCardId(),(function(t){e.setLike(t.likes)}))}He.setEventListeners(),Ve.setEventListeners(),Fe.setEventListeners(),Me.setEventListeners(),Ne.setEventListeners(),Se.addEventListener("click",(function(){Le.checkFormValidityBeforeOpen(),Ve.open()})),ge.addEventListener("click",(function(){var e=Be.getUserInfo(),t=e.name,n=e.job;je.value=t,Pe.value=n,Ie.checkFormValidityBeforeOpen(),He.open()})),qe.addEventListener("click",(function(){xe.checkFormValidityBeforeOpen(),Me.open()})),Le.enableValidation(),Ie.enableValidation(),xe.enableValidation()})();